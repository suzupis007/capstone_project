knitr::opts_chunk$set(echo = TRUE)
# remove unwanted features, create calculated feature, convert fips_code to data type matching chr_data
sdoh_data <- all_sdoh_data %>%
select("COUNTYFIPS",
"STATE",
"COUNTY",
"REGION",
"ACS_TOT_POP_WT",
"ACS_AVG_HH_SIZE",
"ACS_PCT_MALE",
"ACS_PCT_FEMALE",
"ACS_PCT_NON_CITIZEN",
"ACS_PCT_CTZ_NATURALIZED",
"ACS_PCT_CTZ_ABOVE18",
"ACS_PCT_ENGL_NOT_ALL",
"ACS_PCT_AIAN",
"ACS_PCT_ASIAN",
"ACS_PCT_BLACK",
"ACS_PCT_HISPANIC",
"ACS_PCT_OTHER_RACE",
"ACS_PCT_WHITE",
"ACS_PCT_CHILD_1FAM",
"ACS_PCT_CHILDREN_GRANDPARENT",
"ACS_PCT_GRANDP_RESPS_NO_P",
"ACS_PCT_GRANDP_RESPS_P",
"ACS_PCT_HH_NO_COMP_DEV",
"ACS_PCT_HH_SMARTPHONE",
"ACS_PCT_HH_TABLET",
"ACS_PCT_HH_PC",
"ACS_PCT_HH_OTHER_COMP",
"ACS_PCT_HH_INTERNET",
"ACS_PCT_HH_BROADBAND_ANY",
"ACS_PCT_HH_CELLULAR",
"ACS_PCT_HH_NO_INTERNET",
"ACS_PCT_HH_SAT_INTERNET",
"ACS_PCT_HH_DIAL_INTERNET_ONLY",
"ACS_PCT_ADMIN",
"ACS_PCT_ART",
"ACS_PCT_CONSTRUCT",
"ACS_PCT_EDUC",
"ACS_PCT_FINANCE",
"ACS_PCT_GOVT",
"ACS_PCT_INFORM",
"ACS_PCT_MANUFACT",
"ACS_PCT_NATURE",
"ACS_PCT_OTHER",
"ACS_PCT_PROFESS",
"ACS_PCT_PVT_NONPROFIT",
"ACS_PCT_RETAIL",
"ACS_PCT_TRANSPORT",
"ACS_PCT_WHOLESALE",
"ACS_PCT_EMPLOYED",
"ACS_PCT_UNEMPLOY",
"ACS_GINI_INDEX",
"ACS_PCT_HH_INC_10000",
"ACS_PCT_HH_INC_100000",
"ACS_PCT_HH_INC_14999",
"ACS_PCT_HH_INC_24999",
"ACS_PCT_HH_INC_49999",
"ACS_PCT_HH_INC_99999",
"ACS_PER_CAPITA_INC",
"ACS_MEDIAN_HOME_VALUE",
"ACS_MEDIAN_RENT",
"ACS_PCT_VACANT_HU",
"ACS_PCT_COMMT_15MIN",
"ACS_PCT_COMMT_29MIN",
"ACS_PCT_COMMT_59MIN",
"ACS_PCT_COMMT_60MINUP",
"ACS_PCT_PUBL_TRANSIT",
"ACS_PCT_MEDICAID_ANY",
"ACS_PCT_MEDICARE_ONLY",
"AHRF_ADV_NURSES_RATE",
"AHRF_CLIN_NURSE_SPEC_RATE",
"AHRF_DENTISTS_RATE",
"AHRF_NURSE_ANESTH_RATE",
"AHRF_NURSE_MIDWIVES_RATE",
"AHRF_NURSE_PRACT_RATE",
"AHRF_PHYSICIAN_ASSIST_RATE",
"AMFAR_SSP_RATE",
"AMFAR_MEDSAFAC_RATE",
"AMFAR_MHFAC_RATE",
"CEN_AREALAND_SQM_COUNTY",
"CEN_POPDENSITY_COUNTY",
"NEPHTN_HEATIND_90",
"EPAA_2NDMAX_CO_1HR",
"EPAA_98PR_NO2_1HR",
"EPAA_MAX_PB_3MON",
"EPAA_98PR_PM25_DAILY",
"EPAA_99PR_SO2_1HR",
"SAIPE_MEDIAN_HH_INCOME",
"SAIPE_PCT_POV",
"LTC_AVG_OBS_REHOSP_RATE",
"LTC_AVG_OBS_SUCCESSFUL_DISC_RATE",
"MGV_PER_CAPITA_STD_IP",
"MGV_PER_CAPITA_STD_OP",
"MGV_PER_CAPITA_STD_EM",
"MGV_PER_CAPITA_STD_PA",
"MGV_PER_CAPITA_STD_HC",
"POS_MEDIAN_DIST_ED",
"POS_MEDIAN_DIST_MEDSURG_ICU",
"POS_MEDIAN_DIST_TRAUMA",
"POS_MEDIAN_DIST_PED_ICU",
"POS_MEDIAN_DIST_OBSTETRICS",
"POS_MEDIAN_DIST_CLINIC",
"POS_MEDIAN_DIST_ALC",
) %>%
mutate(percent_grandparents_as_guardians = ACS_PCT_CHILDREN_GRANDPARENT * ((ACS_PCT_GRANDP_RESPS_P + ACS_PCT_GRANDP_RESPS_NO_P)/100)) %>%
select(-ACS_PCT_GRANDP_RESPS_P, -ACS_PCT_GRANDP_RESPS_NO_P, -ACS_PCT_CHILDREN_GRANDPARENT) %>%
rename("fips_code" = "COUNTYFIPS",
"state" = "STATE",
"county" = "COUNTY",
"region" = "REGION",
"weighted_population"  = "ACS_TOT_POP_WT",
"average_hh_size" = "ACS_AVG_HH_SIZE",
"pct_male"  = "ACS_PCT_MALE",
"pct_female" = "ACS_PCT_FEMALE",
"pct_not_citizens" = "ACS_PCT_NON_CITIZEN",
"pct_naturalized_citizens" = "ACS_PCT_CTZ_NATURALIZED",
"pct_adult_citizens" = "ACS_PCT_CTZ_ABOVE18",
"pct_no_english_spoken" = "ACS_PCT_ENGL_NOT_ALL",
"pct_native_american" = "ACS_PCT_AIAN",
"pct_asian" = "ACS_PCT_ASIAN",
"pct_black" = "ACS_PCT_BLACK",
"pct_hispanic" = "ACS_PCT_HISPANIC",
"pct_other_race" = "ACS_PCT_OTHER_RACE",
"pct_white" = "ACS_PCT_WHITE",
"pct_single_parent" = "ACS_PCT_CHILD_1FAM",
"pct_hh_no_computing_device" = "ACS_PCT_HH_NO_COMP_DEV",
"pct_hh_smartphone" = "ACS_PCT_HH_SMARTPHONE",
"pct_hh_tablet" = "ACS_PCT_HH_TABLET",
"pct_hh_computer" = "ACS_PCT_HH_PC",
"pct_hh_other_computer" = "ACS_PCT_HH_OTHER_COMP",
"pct_hh_internet" = "ACS_PCT_HH_INTERNET",
"pct_hh_broadband" = "ACS_PCT_HH_BROADBAND_ANY",
"pct_hh_cell_data" = "ACS_PCT_HH_CELLULAR",
"pct_hh_no_internet" = "ACS_PCT_HH_NO_INTERNET",
"pct_hh_satellite" =  "ACS_PCT_HH_SAT_INTERNET",
"pct_hh_dial_up" = "ACS_PCT_HH_DIAL_INTERNET_ONLY",
"pct_employed_admin" = "ACS_PCT_ADMIN",
"pct_employed_arts" = "ACS_PCT_ART",
"pct_employed_construction" = "ACS_PCT_CONSTRUCT",
"pct_employed_education" = "ACS_PCT_EDUC",
"pct_employed_finance" = "ACS_PCT_FINANCE",
"pct_employed_government" = "ACS_PCT_GOVT",
"pct_employed_information" = "ACS_PCT_INFORM",
"pct_employed_manufacturing" = "ACS_PCT_MANUFACT",
"pct_employed_nature" = "ACS_PCT_NATURE",
"pct_employed_other" = "ACS_PCT_OTHER",
"pct_employed_professional" = "ACS_PCT_PROFESS",
"pct_employed_nonprofit" = "ACS_PCT_PVT_NONPROFIT",
"pct_employed_retail" = "ACS_PCT_RETAIL",
"pct_employed_transportation" = "ACS_PCT_TRANSPORT",
"pct_employed_wholesale" = "ACS_PCT_WHOLESALE",
"pct_employed" = "ACS_PCT_EMPLOYED",
"pct_unemployed" = "ACS_PCT_UNEMPLOY",
"gini_index" = "ACS_GINI_INDEX",
"pct_hh_inc_10,000" = "ACS_PCT_HH_INC_10000",
"pct_hh_inc_100,000" = "ACS_PCT_HH_INC_100000",
"pct_hh_inc_14,999" = "ACS_PCT_HH_INC_14999",
"pct_hh_inc_24,999" = "ACS_PCT_HH_INC_24999",
"pct_hh_inc_49,999" = "ACS_PCT_HH_INC_49999",
"pct_hh_inc_99999" = "ACS_PCT_HH_INC_99999",                         # renamed by mg
"per_capita_income" = "ACS_PER_CAPITA_INC",
"median_home_value" = "ACS_MEDIAN_HOME_VALUE",
"median_rent" = "ACS_MEDIAN_RENT",
"pct_houses_vacant" = "ACS_PCT_VACANT_HU",
"pct_15_min_commute" = "ACS_PCT_COMMT_15MIN",
"pct_29_min_commute" = "ACS_PCT_COMMT_29MIN",
"pct_59_min_commute" = "ACS_PCT_COMMT_59MIN",
"pct_60_min_plus_commute" = "ACS_PCT_COMMT_60MINUP",
"pct_public_transportatin" = "ACS_PCT_PUBL_TRANSIT",
"pct_w_medicaid" = "ACS_PCT_MEDICAID_ANY",
"pct_w_medicare" = "ACS_PCT_MEDICARE_ONLY",
"adv_practice_nurse_pt" = "AHRF_ADV_NURSES_RATE",
"clinical_nurse_pt" = "AHRF_CLIN_NURSE_SPEC_RATE",
"dentist_pt" = "AHRF_DENTISTS_RATE",
"anesthetist_nurse_pt" = "AHRF_NURSE_ANESTH_RATE",
"midwife_pt" = "AHRF_NURSE_MIDWIVES_RATE",
"nurse_practitioner_pt" = "AHRF_NURSE_PRACT_RATE",
"pa_pt" = "AHRF_PHYSICIAN_ASSIST_RATE",
"syringe_exchange_pt" = "AMFAR_SSP_RATE",
"substance_abuse_facility_pt" = "AMFAR_MEDSAFAC_RATE",
"mental_health_faciliy_pt" = "AMFAR_MHFAC_RATE",
"land_area_sqm" = "CEN_AREALAND_SQM_COUNTY",
"population_density" = "CEN_POPDENSITY_COUNTY",
"days_over_90_f" = "NEPHTN_HEATIND_90",
"co_measure" = "EPAA_2NDMAX_CO_1HR",
"no2_measure" = "EPAA_98PR_NO2_1HR",
"pb_measure" = "EPAA_MAX_PB_3MON",
"pm_2.5_measure" = "EPAA_98PR_PM25_DAILY",
"so2_measure" = "EPAA_99PR_SO2_1HR",
"median_hh_income" = "SAIPE_MEDIAN_HH_INCOME",
"pct_people_in_poverty" = "SAIPE_PCT_POV",
"rehospitalization_rate" = "LTC_AVG_OBS_REHOSP_RATE",
"successful_discharge_rate" = "LTC_AVG_OBS_SUCCESSFUL_DISC_RATE",
"medicare_inpatient_payment" = "MGV_PER_CAPITA_STD_IP"         ,
"medicare_outpatient_payment" = "MGV_PER_CAPITA_STD_OP",
"medicare_e&m_payment" = "MGV_PER_CAPITA_STD_EM",
"medicare_acute_care_payment" = "MGV_PER_CAPITA_STD_PA",
"medicare_fqrc_rhc_payment" = "MGV_PER_CAPITA_STD_HC",
"median_er_dist" = "POS_MEDIAN_DIST_ED",
"median_surgery_dist" = "POS_MEDIAN_DIST_MEDSURG_ICU",
"median_trauma_center_dist" = "POS_MEDIAN_DIST_TRAUMA",
"median_pediatric_icu_dist" = "POS_MEDIAN_DIST_PED_ICU",
"median_obstetrics_dist" = "POS_MEDIAN_DIST_OBSTETRICS",
"median_health_clinic_dist" = "POS_MEDIAN_DIST_CLINIC",
"median_drug_alcohol_care_dist" = "POS_MEDIAN_DIST_ALC"
) %>%
mutate(fips_code = as.numeric(fips_code))
